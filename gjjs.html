<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>WDL 学术平台 - 高级检索</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      min-height: 100vh;
      margin: 0;
      background: #eaf1fa url('https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=1500&q=80') no-repeat center center/cover;
      font-family: "PingFang SC", "Microsoft YaHei", Arial, sans-serif;
    }
    .topbar {
      display: flex;
      align-items: center;
      padding: 30px 0 0 40px;
    }
    .topbar img {
      height: 38px;
      margin-right: 12px;
    }
    .topbar .title {
      font-size: 1.7rem;
      font-weight: bold;
      color: #1976d2;
      margin-right: 12px;
      letter-spacing: 1px;
    }
    .topbar .subtitle {
      color: #88a4c2;
      font-size: 1rem;
    }
    .main-flex {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 38px;
      margin-top: 50px;
    }
    .container {
      width: 520px;
      min-width: 320px;
      padding: 32px 32px 24px 32px;
      border-radius: 22px;
      box-shadow: 0 8px 32px 0 rgba(36,72,125,0.09);
      background: rgba(255,255,255,0.97);
      z-index: 1;
      position: relative;
    }
    .adv-title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    .adv-title {
      font-size: 1.25rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      color: #1769c2;
      letter-spacing: 1px;
    }
    .adv-title i {
      font-size: 1.7rem;
      margin-right: 10px;
      color: #53a0fa;
    }
    .actions-bar {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .del-all-btn {
      background: #f5f6fa;
      border: none;
      color: #e55d5d;
      border-radius: 7px;
      padding: 7px 14px;
      font-size: 1.15em;
      cursor: pointer;
      margin-right: 5px;
      transition: background .13s, color .16s;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .del-all-btn[disabled] {
      background: #f1f3f7;
      color: #b9c2c9;
      cursor: not-allowed;
    }
    .del-all-btn:not([disabled]):hover {
      background: #ffebec;
      color: #bc3242;
    }
    .tips-icon-btn {
      background: #f0f7ff;
      border: none;
      border-radius: 50%;
      width: 34px;
      height: 34px;
      color: #3c78d6;
      font-size: 1.35em;
      cursor: pointer;
      margin-left: 5px;
      box-shadow: 0 2px 12px #c5dbff3a;
      transition: background .18s, color .18s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tips-icon-btn:hover { background: #dbe8f6; color: #235ea5;}
    #advRows {
      margin-bottom: 10px;
    }
    .search-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      gap: 8px;
      animation: fadeIn .6s;
    }
    @keyframes fadeIn { from { opacity:0; transform:translateY(-10px);} to {opacity:1;transform:none;} }
    .logic-select, .field-select {
      border: 1px solid #dde6f3;
      border-radius: 6px;
      padding: 5px 16px 5px 10px;
      font-size: 1rem;
      background: #f7faff;
      color: #3269c5;
      outline: none;
      transition: border 0.2s;
    }
    .logic-select { min-width: 70px; font-weight: bold; background: #e6f0ff; }
    .field-select { min-width: 88px; }
    .kw-input {
      flex: 1;
      border: 1.2px solid #dde6f3;
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 1rem;
      background: #f8fbff;
      color: #222;
      outline: none;
      transition: border 0.2s;
    }
    .kw-input:focus { border: 1.5px solid #66aaff; }
    .del-btn {
      background: none;
      border: none;
      color: #d73a49;
      font-size: 1.35rem;
      cursor: pointer;
      padding: 2px 7px;
      margin-left: 2px;
      border-radius: 50%;
      transition: background 0.13s;
    }
    .del-btn:hover { background: #fbe6ea; }
    .add-row-btn {
      display: inline-block;
      background: #f0f6ff;
      color: #2176d5;
      border: none;
      font-size: 1rem;
      padding: 7px 18px 7px 12px;
      margin-bottom: 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background .18s;
      margin-top: 4px;
      margin-left: 2px;
    }
    .add-row-btn:hover { background: #e5effb; color: #155fa0; }
    .search-btn {
      width: 100%;
      background: linear-gradient(90deg,#2486ea,#3474dc 85%);
      color: #fff;
      font-size: 1.25rem;
      font-weight: bold;
      padding: 13px 0;
      border-radius: 12px;
      border: none;
      box-shadow: 0 4px 24px rgba(70,132,222,0.08);
      cursor: pointer;
      transition: background 0.16s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      letter-spacing: 2px;
    }
    .search-btn i {
      font-size: 1.5rem;
      margin-top: -1px;
    }
    .search-btn:hover {
      background: linear-gradient(90deg,#309afc,#4d7adf 85%);
    }
    /* 使用说明区样式 */
    .tips-box {
      min-width: 340px;
      max-width: 420px;
      background: rgba(235,244,255,0.97);
      border-radius: 20px;
      box-shadow: 0 8px 24px rgba(110,170,222,0.07);
      padding: 28px 26px 18px 26px;
      color: #3765aa;
      font-size: 15px;
      line-height: 1.7;
      letter-spacing: 0.5px;
      margin-top: 8px;
      transition: width 0.23s, opacity .3s;
      position: relative;
      opacity: 1;
      animation: fadeIn .7s;
    }
    .tips-box.hide { opacity: 0; pointer-events: none; display: none;}
    .tips-box strong { color: #2266ad; }
    .tips-box li { margin-bottom: 7px;}
    .tips-box .close-tips {
      position: absolute;
      right: 15px; top: 14px;
      background: none;
      border: none;
      color: #8ea9c7;
      font-size: 1.6em;
      cursor: pointer;
      padding: 0 7px;
      transition: color .13s;
    }
    .tips-box .close-tips:hover { color: #db3a4c; }
    @media (max-width: 1100px) {
      .main-flex { flex-direction: column; align-items: center; gap: 22px; }
      .tips-box { min-width: 200px; max-width: 97vw; margin: 16px 0 0 0;}
      .container { margin: 36px 10px 0; }
    }
    @media (max-width: 680px) {
      .container { width: 97vw; padding: 14px 2vw; }
      .tips-box { font-size: 14px; padding: 15px 8px; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <img src="https://cdn.jsdelivr.net/gh/wxkfree/imgbed/logo/wdl_owl_blue.png" alt="Logo">
    <span class="title">WDL 学术平台</span>
    <span class="subtitle">New Academic</span>
  </div>
  <div class="main-flex">
    <form id="advForm" class="container" autocomplete="off">
      <div class="adv-title-row">
        <div class="adv-title"><i class="ri-filter-3-line"></i>高级检索</div>
        <div class="actions-bar">
          <button type="button" id="delAllBtn" class="del-all-btn" title="清空全部条件" disabled>
            <i class="ri-delete-bin-6-line"></i>清空
          </button>
          <button type="button" id="showTipsBtn" class="tips-icon-btn" title="使用说明">
            <i class="ri-question-line"></i>
          </button>
        </div>
      </div>
      <div id="advRows"></div>
      <button type="button" class="add-row-btn" onclick="addRow()">
        <i class="ri-add-line" style="font-size:1.1em"></i> 添加检索条件
      </button>
      <button class="search-btn" type="submit"><i class="ri-search-line"></i>搜索</button>
    </form>
    <!-- 使用说明区 -->
    <div id="tipsBox" class="tips-box hide">
      <button class="close-tips" onclick="hideTips()" title="收起说明"><i class="ri-close-line"></i></button>
      <strong><i class="ri-lightbulb-flash-line"></i> 高级检索须知：</strong>
      <ul>
        <li>1. 每个输入框默认支持英文逗号，不支持分句全文检索。</li>
        <li>2. 可选择标题、作者、关键词、导师、学科、学校、关键信息、摘要、出版年份、语种和所用检索逻辑。</li>
        <li>3. 高级检索支持多个检索项同时拼接，系统智能处理 “AND、OR、NOT” 的逻辑关系，查重去重。</li>
      </ul>
    </div>
  </div>
  <script>
    const fields = [
      {label: '标题', value: 'title'},
      {label: '作者', value: 'author'},
      {label: '关键词', value: 'keyword'},
      {label: '导师', value: 'tutor'},
      {label: '学科', value: 'subject'},
      {label: '学校', value: 'school'},
      {label: '关键信息', value: 'info'},
      {label: '摘要', value: 'abstract'},
      {label: '出版年份', value: 'year'},
      {label: '语种', value: 'language'}
    ];
    const logics = ['AND', 'OR', 'NOT'];
    let advRowsData = [{logic: 'AND', field:'title', value:''}];

    function renderAdvRows() {
      const rows = advRowsData.map((row, idx) => {
        return `
        <div class="search-row" data-row="${idx}">
          <select class="logic-select" style="margin-right:7px;">
            ${logics.map(l => `<option value="${l}"${row.logic===l?' selected':''}>${l}</option>`).join('')}
          </select>
          <select class="field-select">
            ${fields.map(f => `<option value="${f.value}"${row.field===f.value?' selected':''}>${f.label}</option>`).join('')}
          </select>
          <input class="kw-input" type="text" placeholder="请输入检索词" value="${row.value||''}" />
          ${advRowsData.length > 1 ? `<button type="button" class="del-btn" title="删除本行"><i class="ri-close-line"></i></button>` : ''}
        </div>
        `;
      }).join('');
      document.getElementById('advRows').innerHTML = rows;
      document.querySelectorAll('.search-row').forEach((rowEl, idx) => {
        // 逻辑
        rowEl.querySelector('.logic-select').onchange = e => {
          advRowsData[idx].logic = e.target.value;
        };
        // 字段
        rowEl.querySelector('.field-select').onchange = e => {
          advRowsData[idx].field = e.target.value;
        };
        // 关键词
        rowEl.querySelector('.kw-input').oninput = e => {
          advRowsData[idx].value = e.target.value;
        };
        // 删除
        if (rowEl.querySelector('.del-btn')) {
          rowEl.querySelector('.del-btn').onclick = () => {
            advRowsData.splice(idx, 1);
            renderAdvRows();
            updateDelAllBtn();
          }
        }
      });
      updateDelAllBtn();
    }
    function addRow() {
      advRowsData.push({logic:'AND', field:'title', value:''});
      renderAdvRows();
      updateDelAllBtn();
    }
    function deleteAllRows() {
      advRowsData = [{logic:'AND', field:'title', value:''}];
      renderAdvRows();
      updateDelAllBtn();
    }
    function updateDelAllBtn() {
      const btn = document.getElementById('delAllBtn');
      btn.disabled = advRowsData.length <= 1;
    }
    renderAdvRows();
    document.getElementById('advForm').onsubmit = function() {
      alert('高级检索条件：\n' + JSON.stringify(advRowsData, null, 2));
      return false;
    };

    // 一键删除全部行
    document.getElementById('delAllBtn').onclick = function(){
      if(this.disabled) return;
      if(confirm("确认清空全部检索条件？")) deleteAllRows();
    };

    // 说明区收起展开
    function hideTips() {
      document.getElementById('tipsBox').classList.add("hide");
      document.getElementById('showTipsBtn').style.display = "";
    }
    function showTips() {
      document.getElementById('tipsBox').classList.remove("hide");
      document.getElementById('showTipsBtn').style.display = "none";
    }
    // 小问号按钮
    document.getElementById('showTipsBtn').onclick = showTips;
    // 初始隐藏说明
    hideTips();
  </script>
</body>
</html>
